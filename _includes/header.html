<header class="site-header">
  <div class="container">
    <a href="/{{ page.lang }}/" class="logo">
      Emanuela Pau
    </a>
    
    <nav>
      <ul>
        {% assign current_lang = page.lang | default: "en" %}
        {% for item in site.data.navigation[current_lang] %}
          <li>
            <a href="{{ item.url }}" {% if page.url == item.url %}class="active"{% endif %}>
              {{ item.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </nav>
    
    <div class="lang-switch">
      <!-- Simple logic: Replace the first occurrence of the current lang code with the target lang code -->
      <a href="{{ page.url | replace_first: '/it/', '/en/' | replace_first: '/es/', '/en/' }}" {% if page.lang == 'en' %}class="active"{% endif %}>EN</a>
      <a href="{{ page.url | replace_first: '/en/', '/it/' | replace_first: '/es/', '/it/' }}" {% if page.lang == 'it' %}class="active"{% endif %}>IT</a>
      <a href="{{ page.url | replace_first: '/en/', '/es/' | replace_first: '/it/', '/es/' }}" {% if page.lang == 'es' %}class="active"{% endif %}>ES</a>
    </div>
  </div>
</header>
